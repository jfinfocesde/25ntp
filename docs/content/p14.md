# Semana 14: Despliegue de Aplicaciones Streamlit en la Nube

## Objetivos de la Semana

- Aprender a desplegar aplicaciones Streamlit en servicios cloud gratuitos
- Comprender los conceptos b√°sicos de despliegue web
- Configurar repositorios Git para despliegue autom√°tico
- Resolver problemas comunes en el despliegue

## Introducci√≥n al Despliegue en la Nube

El despliegue en la nube permite que tus aplicaciones Streamlit est√©n disponibles 24/7 en internet sin necesidad de mantener tu computadora encendida. Existen varias plataformas que ofrecen servicios gratuitos perfectos para proyectos educativos y prototipos.

## Opciones de Despliegue Gratuito

### 1. Streamlit Community Cloud (Recomendado)

**Ventajas:**

- Dise√±ado espec√≠ficamente para Streamlit
- Despliegue autom√°tico desde GitHub
- Sin l√≠mite de tiempo de ejecuci√≥n
- Soporte para dependencias personalizadas

**Requisitos:**

- Cuenta de GitHub
- Repositorio p√∫blico con tu aplicaci√≥n

### 2. Heroku

**Ventajas:**

- Soporte para m√∫ltiples lenguajes
- Buena documentaci√≥n
- Dyno gratuito disponible

**Limitaciones:**

- Se duerme despu√©s de 30 minutos de inactividad
- L√≠mite de horas mensuales

### 3. Railway

**Ventajas:**

- Interfaz moderna
- Despliegue desde GitHub
- Buen rendimiento

**Limitaciones:**

- Cr√©dito mensual limitado en plan gratuito

## Tutorial: Despliegue en Streamlit Community Cloud

### Paso 1: Preparar tu Aplicaci√≥n

1. **Estructura del proyecto:**
```
mi-app-streamlit/
‚îú‚îÄ‚îÄ app.py              # Archivo principal
‚îú‚îÄ‚îÄ requirements.txt    # Dependencias
‚îú‚îÄ‚îÄ README.md          # Documentaci√≥n
‚îî‚îÄ‚îÄ .gitignore        # Archivos a ignorar
```

2. **Crear requirements.txt:**
```txt
streamlit>=1.28.0
pandas>=1.5.0
numpy>=1.24.0
# Agrega aqu√≠ todas las librer√≠as que uses
```

3. **Configurar app.py:**
```python
import streamlit as st
import pandas as pd
import numpy as np

# Configuraci√≥n de la p√°gina
st.set_page_config(
    page_title="Mi Aplicaci√≥n Streamlit",
    page_icon="üöÄ",
    layout="wide"
)

st.title("¬°Hola desde la nube! üå§Ô∏è")
st.write("Esta aplicaci√≥n est√° desplegada en Streamlit Community Cloud")

# Tu c√≥digo aqu√≠
```

### Paso 2: Subir a GitHub

1. **Crear repositorio en GitHub:**

    - Ve a [github.com](https://github.com)
    - Crea un nuevo repositorio p√∫blico
    - No inicialices con README (ya tienes uno local)

2. **Subir tu c√≥digo:**
```bash
git init
git add .
git commit -m "Primera versi√≥n de mi app Streamlit"
git branch -M main
git remote add origin https://github.com/TU_USUARIO/TU_REPOSITORIO.git
git push -u origin main
```

### Paso 3: Desplegar en Streamlit Community Cloud

1. **Crear cuenta:**

    - Ve a [share.streamlit.io](https://share.streamlit.io)
    - Inicia sesi√≥n con tu cuenta de GitHub

2. **Desplegar aplicaci√≥n:**

    - Haz clic en "New app"
    - Selecciona tu repositorio
    - Elige la rama (main)
    - Especifica el archivo principal (app.py)
    - Haz clic en "Deploy"

3. **Esperar el despliegue:**

    - El proceso toma 2-5 minutos
    - Recibir√°s una URL como: `https://tu-app.streamlit.app`

## Configuraci√≥n Avanzada

### Variables de Entorno

Para aplicaciones m√°s complejas, puedes usar variables de entorno:

```python
import os
import streamlit as st

# En tu app.py
API_KEY = os.getenv('API_KEY', 'valor_por_defecto')
st.write(f"API Key: {API_KEY}")
```

Configurar en Streamlit Cloud:

1. Ve al dashboard de tu app
2. Haz clic en "Settings"
3. En "Secrets", agrega:

```toml
API_KEY = "tu_clave_secreta"
```

### Manejo de Errores

```python
import streamlit as st
import traceback

try:
    # Tu c√≥digo principal
    st.title("Mi Aplicaci√≥n")
    # ... resto del c√≥digo
except Exception as e:
    st.error(f"Error: {str(e)}")
    st.code(traceback.format_exc())
```

## Soluci√≥n de Problemas Comunes

### Error: "No module named 'xxx'"

**Soluci√≥n:** Aseg√∫rate de incluir todas las dependencias en `requirements.txt`

### Error: "App is taking too long to load"

**Soluciones:**

- Optimiza tu c√≥digo
- Usa `@st.cache_data` para funciones costosas
- Reduce el tama√±o de datasets

### Error: "Memory limit exceeded"

**Soluciones:**

- Procesa datos en chunks
- Usa muestras de datos grandes
- Optimiza el uso de memoria

## Mejores Pr√°cticas

### 1. Optimizaci√≥n de Rendimiento

```python
import streamlit as st

@st.cache_data
def cargar_datos():
    # Esta funci√≥n solo se ejecuta una vez
    return pd.read_csv('datos_grandes.csv')

@st.cache_resource
def crear_modelo():
    # Para modelos ML que no cambian
    return cargar_modelo_ml()
```

### 2. Dise√±o Responsivo

```python
# Usar columnas responsivas
col1, col2 = st.columns([2, 1])

with col1:
    st.write("Contenido principal")

with col2:
    st.write("Barra lateral")
```

### 3. Documentaci√≥n Clara

```python
# Agrega docstrings y comentarios
def procesar_datos(df):
    """
    Procesa el DataFrame y retorna estad√≠sticas.
    
    Args:
        df: DataFrame de entrada
    
    Returns:
        dict: Diccionario con estad√≠sticas
    """
    return df.describe()
```

## Ejercicio Pr√°ctico

### Desaf√≠o: Desplegar tu Primera App

1. **Crea una aplicaci√≥n simple** que muestre:

    - Un gr√°fico interactivo
    - Un dataframe filtrable
    - Informaci√≥n sobre el dataset

2. **Sigue los pasos del tutorial** para desplegarla

3. **Comparte tu URL** en el foro de la clase

### Ejemplo de Aplicaci√≥n

```python
import streamlit as st
import pandas as pd
import plotly.express as px

st.set_page_config(page_title="An√°lisis de Datos", layout="wide")

# Cargar datos
@st.cache_data
def cargar_datos():
    return pd.read_csv('https://raw.githubusercontent.com/plotly/datasets/master/iris.csv')

df = cargar_datos()

# Sidebar
st.sidebar.header("Filtros")
especie = st.sidebar.selectbox("Seleccionar especie:", df['Name'].unique())

# Main content
st.title("An√°lisis del Dataset Iris")

# Filtrar datos
filtered_df = df[df['Name'] == especie]

# Mostrar m√©tricas
col1, col2, col3 = st.columns(3)
col1.metric("Total de muestras", len(filtered_df))
col2.metric("Promedio Sepal Length", f"{filtered_df['SepalLength'].mean():.2f}")
col3.metric("Promedio Petal Length", f"{filtered_df['PetalLength'].mean():.2f}")

# Gr√°fico
fig = px.scatter(filtered_df, x='SepalLength', y='PetalLength', 
                 color='Name', title=f'Dispersi√≥n para {especie}')
st.plotly_chart(fig, use_container_width=True)

# Tabla de datos
st.subheader("Datos filtrados")
st.dataframe(filtered_df)
```

## Tarea de la Semana

1. Despliega al menos una aplicaci√≥n Streamlit en la nube
2. Documenta el proceso con capturas de pantalla
5. Crea un README profesional para tu repositorio



